### nonhomref column 5
mean(datgatfil$V5)
## het column 6
mean(datgatfil$V6)
##singleton column 11
mean(datgatfil$V11)
# Ti/Tv
mean(datgatfil$V7/datgatfil$V8)
## get PSI (grep "PSI" gatk_fill_all.stats|grep -v "#" |pbcopy)
datgatind <- read.table(pipe("pbpaste"), header = FALSE)
head(datgatind)
##het column 8
mean(datgatind$V8)
mean(datgatind$V9)
hist(iris$Sepal.Length)
# ### Het and singleton stats per sample ----------------------------------
library("tidyverse")
datgatfil <- read.table(pipe("pbpaste"), header = FALSE)
datgatfil <- datgatfil %>% filter(V3 != "BSWCHEM120111313935")
## get PSI (grep "PSI" gatk_fill_all.stats|grep -v "#" |pbcopy)
datgatind <- read.table(pipe("pbpaste"), header = FALSE)
head(datgatind)
##het column 8
mean(datgatind$V8)
mean(datgatind$V9)
datgatfil <- read.table(pipe("pbpaste"), header = FALSE)
datgatfil <- datgatfil %>% filter(V3 != "BSWCHEM120111313935")
### nonhomref column 5
mean(datgatfil$V5)
## het column 6
mean(datgatfil$V6)
##singleton column 11
mean(datgatfil$V11)
# Ti/Tv
mean(datgatfil$V7/datgatfil$V8)
library("ggplot2")
library("cowplot")
setwd("~/Google_Drive/paper/paper_graph/result/computation_time/ucd_comparison")
dir()
datumd <- read.table("12_temp_corr.txt",header=FALSE)
datumd <- datumd[1:3]
datucd <- read.table("ch12_ucd.tsv",header=FALSE)
head(datucd)
colnames(datucd) <- c("chr","chunk","time")
colnames(datumd)<- c("chr","chunk","time")
datucd$assembly <- rep("ucd",length=nrow(datucd))
datumd$assembly <- rep("umd",length=nrow(datumd))
dattime <- rbind(datucd,datumd)
dattime$chunk2 <- as.numeric(dattime$chunk * 1000000)
pd <- ggplot(dattime,aes(x=chunk2,y=time,col=assembly))+
geom_point()+
geom_line()+
theme_grey()+
theme(legend.position = c(0.9,0.85),
legend.background = element_rect(colour = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.text = element_text(size=12),
legend.title = element_text(size=12),
axis.text = element_text(size=12))+
scale_color_brewer(palette = "Set1")+
scale_y_continuous(breaks = seq(0,6000,2000),limits = c(0,6000))
pd
View(dattime %>% filter(assembly=="umd"))
dir()
denumd <- read.table("ch12_umd_den.snpden",header=TRUE)
denucd <- read.table("ch12_ucd_den.snpden",header=TRUE)
denumd$assembly <- rep("umd",nrow(denumd))
denucd$assembly <- rep("ucd",nrow(denucd))
dendat <- rbind(denumd,denucd)
#remove 0 entry
## need to set limit for the threshold to join
dendat <- dendat %>% mutate(BIN_START=BIN_START+1000000)
pden <- ggplot(dendat,aes(x=BIN_START,y=SNP_COUNT,col=assembly)) +
geom_line(show.legend = FALSE)+
theme_grey()+
scale_color_brewer(palette = "Set1")+
theme(axis.text = element_text(size=12))+
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,25000))
pden
pd
pgs <- plot_grid(pd,pden,nrow=2,rel_heights = c(1,0.4),align = "v")
pgs
pgs <- plot_grid(pd,pden,nrow=2,rel_heights = c(1,0.4),align = "hv")
pgs
library("ggplot2")
library("cowplot")
setwd("~/Google_Drive/paper/paper_graph/result/computation_time/ucd_comparison")
dir()
datumd <- read.table("12_temp_corr.txt",header=FALSE)
datumd <- datumd[1:3]
datucd <- read.table("ch12_ucd.tsv",header=FALSE)
head(datucd)
colnames(datucd) <- c("chr","chunk","time")
colnames(datumd)<- c("chr","chunk","time")
datucd$assembly <- rep("ucd",length=nrow(datucd))
datumd$assembly <- rep("umd",length=nrow(datumd))
dattime <- rbind(datucd,datumd)
dattime$chunk2 <- as.numeric(dattime$chunk * 1000000)
pd <- ggplot(dattime,aes(x=chunk2,y=time,col=assembly))+
geom_point()+
geom_line()+
theme_grey()+
theme(legend.position = c(0.9,0.85),
legend.background = element_rect(colour = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.text = element_text(size=12),
legend.title = element_text(size=12),
axis.text = element_text(size=12))+
scale_color_brewer(palette = "Set1")
pd
View(dattime %>% filter(assembly=="umd"))
dir()
denumd <- read.table("ch12_umd_den.snpden",header=TRUE)
denucd <- read.table("ch12_ucd_den.snpden",header=TRUE)
denumd$assembly <- rep("umd",nrow(denumd))
denucd$assembly <- rep("ucd",nrow(denucd))
dendat <- rbind(denumd,denucd)
#remove 0 entry
## need to set limit for the threshold to join
dendat <- dendat %>% mutate(BIN_START=BIN_START+1000000)
pden <- ggplot(dendat,aes(x=BIN_START,y=SNP_COUNT,col=assembly)) +
geom_line(show.legend = FALSE)+
theme_grey()+
scale_color_brewer(palette = "Set1")+
theme(axis.text = element_text(size=12))
pden
pd
##plot only density and time
pgs <- plot_grid(pd,pden,nrow=2,rel_heights = c(1,0.4),align = "v")
pgs
library("ggplot2")
library("cowplot")
setwd("~/Google_Drive/paper/paper_graph/result/computation_time/ucd_comparison")
dir()
datumd <- read.table("12_temp_corr.txt",header=FALSE)
datumd <- datumd[1:3]
datucd <- read.table("ch12_ucd.tsv",header=FALSE)
head(datucd)
colnames(datucd) <- c("chr","chunk","time")
colnames(datumd)<- c("chr","chunk","time")
datucd$assembly <- rep("ucd",length=nrow(datucd))
datumd$assembly <- rep("umd",length=nrow(datumd))
dattime <- rbind(datucd,datumd)
dattime$chunk2 <- as.numeric(dattime$chunk * 1000000)
pd <- ggplot(dattime,aes(x=chunk2,y=time,col=assembly))+
geom_point()+
geom_line()+
theme_grey()+
theme(legend.position = c(0.9,0.85),
legend.background = element_rect(colour = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.text = element_text(size=12),
legend.title = element_text(size=12),
axis.text = element_text(size=12))+
scale_color_brewer(palette = "Set1")+
scale_y_continuous(breaks = seq(0,6000,2000),limits = c(0,6000))
pd
View(dattime %>% filter(assembly=="umd"))
dir()
denumd <- read.table("ch12_umd_den.snpden",header=TRUE)
denucd <- read.table("ch12_ucd_den.snpden",header=TRUE)
denumd$assembly <- rep("umd",nrow(denumd))
denucd$assembly <- rep("ucd",nrow(denucd))
dendat <- rbind(denumd,denucd)
#remove 0 entry
## need to set limit for the threshold to join
dendat <- dendat %>% mutate(BIN_START=BIN_START+1000000)
pden <- ggplot(dendat,aes(x=BIN_START,y=SNP_COUNT,col=assembly)) +
geom_line(show.legend = FALSE)+
theme_grey()+
scale_color_brewer(palette = "Set1")+
theme(axis.text = element_text(size=12))+
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,25000))
pden
pd
pgs <- plot_grid(pd,pden,nrow=2,rel_heights = c(1,0.4),align = "hv")
pgs
head(dattime)
head(dendat)
#remove 0 entry
## need to set limit for the threshold to join
dendat <- dendat %>% mutate(BIN_START=BIN_START+1000000)
pden <- ggplot(dendat[-1,],aes(x=BIN_START,y=SNP_COUNT,col=assembly)) +
geom_line(show.legend = FALSE)+
theme_grey()+
scale_color_brewer(palette = "Set1")+
theme(axis.text = element_text(size=12))+
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,25000))
pden
# revised ucd comp chr12 --------------------------------------------------------
library("tidyverse")
library("ggplot2")
library("cowplot")
setwd("~/Google_Drive/paper/paper_graph/result/computation_time/ucd_comparison")
dir()
datumd <- read.table("12_temp_corr.txt",header=FALSE)
datumd <- datumd[1:3]
datucd <- read.table("ch12_ucd.tsv",header=FALSE)
head(datucd)
colnames(datucd) <- c("chr","chunk","time")
colnames(datumd)<- c("chr","chunk","time")
datucd$assembly <- rep("ucd",length=nrow(datucd))
datumd$assembly <- rep("umd",length=nrow(datumd))
dattime <- rbind(datucd,datumd)
dattime$chunk2 <- as.numeric(dattime$chunk * 1000000)
pd <- ggplot(dattime,aes(x=chunk2,y=time,col=assembly))+
geom_point()+
geom_line()+
theme_grey()+
theme(legend.position = c(0.9,0.85),
legend.background = element_rect(colour = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.text = element_text(size=12),
legend.title = element_text(size=12),
axis.text = element_text(size=12))+
scale_color_brewer(palette = "Set1")+
scale_y_continuous(breaks = seq(0,6000,2000),limits = c(0,6000))
pd
View(dattime %>% filter(assembly=="umd"))
dir()
denumd <- read.table("ch12_umd_den.snpden",header=TRUE)
denucd <- read.table("ch12_ucd_den.snpden",header=TRUE)
denumd$assembly <- rep("umd",nrow(denumd))
denucd$assembly <- rep("ucd",nrow(denucd))
dendat <- rbind(denumd,denucd)
#remove 0 entry
## need to set limit for the threshold to join
dendat <- dendat %>% mutate(BIN_START=BIN_START+1000000)
pden <- ggplot(dendat[-1,],aes(x=BIN_START,y=SNP_COUNT,col=assembly)) +
geom_line(show.legend = FALSE)+
theme_grey()+
scale_color_brewer(palette = "Set1")+
theme(axis.text = element_text(size=12))+
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,25000))
pden
pd
pgs <- plot_grid(pd,pden,nrow=2,rel_heights = c(1,0.4),align = "hv")
pgs
pden <- ggplot(dendat[-1,],aes(x=BIN_START,y=SNP_COUNT,col=assembly)) +
geom_line(show.legend = FALSE)+
geom_point(show.legend = FALSE)+
theme_grey()+
scale_color_brewer(palette = "Set1")+
theme(axis.text = element_text(size=12))+
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,25000))
pden
pgs <- plot_grid(pd,pden,nrow=2,rel_heights = c(1,0.4),align = "hv")
pgs
ggsave("ch12_ucm_edit.svg")
ggsave("ch12_ucm_edit_2.svg",width=10,height = 10/1.61)
ggsave("ch12_ucm_edit_3.svg",width=10.4,height = 9.87)
# filtered concordance ----------------------------------------------------
setwd("~/Google_Drive/paper/paper_graph/result/concordance/fil")
library("tidyverse")
library("cowplot")
dir()
gt <- read.table("filter_concor_tidy.tsv",header=TRUE)
unique(gt$prog)
## use mutate if and format to increase significant digit
gt %>%
filter(anims!="BSWCHEM120111313935") %>%
group_by(prog) %>%
summarise(nc=mean(concor),
ns=mean(NRS),
nd=mean(NRD)) %>%
mutate_if(is.numeric,format,4)
#graph nofil
gpn <- read.table("graph_nofil.tsv",header = TRUE)
gpn %>%
filter(anims!="BSWCHEM120111313935") %>%
group_by(prog) %>%
summarise(nc=mean(concor),
ns=mean(NRS),
nd=mean(NRD)) %>%
mutate_if(is.numeric,format,4)
##sam nofil
gsn <- read.table("sam_nofil_tidy2.tsv",header = TRUE)
gsn %>%
filter(anims!="BSWCHEM120111313935") %>%
group_by(prog) %>%
summarise(nc=mean(concor),
ns=mean(NRS),
nd=mean(NRD)) %>%
mutate_if(is.numeric,format,4)
##gat nofil
ggn <- read.table("gat_nofil_tidy.tsv",header = TRUE)
ggn %>%
filter(anims!="BSWCHEM120111313935") %>%
group_by(prog) %>%
summarise(nc=mean(concor),
ns=mean(NRS),
nd=mean(NRD)) %>%
mutate_if(is.numeric,format,4)
### concatenate all data and
### calculate the het and homcon
dall <- rbind(gt,gpn,gsn,ggn)
head(dall)
#write.table(dall,file = "dat_all.tsv",sep="\t",quote = FALSE,row.names = FALSE)
het_ind <- paste0("index_",c("B","E","H","K"))
hom_ind <- paste0("index_",c("C","F","I","L"))
hetcon <- dall[,"index_E"]*100/rowSums(dall[,het_ind])
homcon <- dall[,"index_I"]*100/rowSums(dall[,hom_ind])
dall$hetcon <- hetcon
dall$homcon <- homcon
dall %>%
filter(anims!="BSWCHEM120111313935") %>%
group_by(prog) %>%
summarise(nht=mean(hetcon),
nhom=mean(homcon)) %>%
mutate_if(is.numeric,format,4)
dcov <- do.call(rbind,lapply(paste0("coverage/",dir("coverage/")),function(x) read.table(x,header=FALSE)))
colnames(dcov) <- c("anims","coverage")
mcov <- dcov %>%
group_by(anims) %>%
summarise(coverage=mean(coverage))
pdall <- dall %>%
left_join(mcov) %>%
filter(anims != "BSWCHEM120111313935")
head(pdall)
unique(pdall$prog)
pdl <- pdall %>%
filter(prog %in% c("gatk4","samtools","graphtyper_uniq"))
pdk <- pdall %>% gather(contipe,propc,hetcon:homcon)
pdj <- pdk %>% group_by(prog,anims,contipe) %>%
summarise(mp=mean(propc),
mc=mean(coverage))
## prog gatk
pl1 <- pdj %>% filter(prog=="gatk4") %>%
ggplot() +
geom_point(aes(x=mc,y=mp,col=contipe))+
facet_wrap(~prog)+
theme_bw()+
scale_color_brewer(palette = "Set1",labels=c("Heterozygous","Homozygous"))+
theme(axis.text = element_text(size=16),
axis.title.y = element_text(size=16,face="bold"),
axis.title.x=element_blank(),
legend.position = "none")+
labs(y="Concordance (%)")+
coord_cartesian(ylim = c(50,100))
pl2 <- pdj %>% filter(prog=="gatk4") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())
pl2
pc1 <- ggdraw()+
draw_plot(pl1,0,0,1,1)+
draw_plot(pl2,0.6,0.3,0.3,0.4)
pc1
pl3 <- pdj %>% filter(prog=="samtools") %>%
ggplot() +
geom_point(aes(x=mc,y=mp,col=contipe))+
facet_wrap(~prog)+
theme_bw()+
scale_color_brewer(palette = "Set1",labels=c("Heterozygous","Homozygous"))+
theme(axis.text = element_text(size=16),
axis.title = element_text(size=16,face="bold"),
legend.position = c(0.81,0.1),
legend.title = element_blank(),
legend.background = element_rect(colour = "black"),
legend.text = element_text(size=16))+
labs(x=NULL,y=NULL)+
coord_cartesian(ylim = c(50,100))
pl4<- pdj %>% filter(prog=="samtools") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())
pc2 <- ggdraw()+
draw_plot(pl3,0,0,1,1)+
draw_plot(pl4,0.6,0.3,0.3,0.4)
pc2
### graph
pl5 <- pdj %>% filter(prog=="graphtyper_uniq") %>%
ggplot() +
geom_point(aes(x=mc,y=mp,col=contipe))+
facet_wrap(~prog)+
theme_bw()+
scale_color_brewer(palette = "Set1",labels=c("Heterozygous","Homozygous"))+
theme(axis.text = element_text(size=16),
axis.title = element_blank(),
legend.position = "none")+
labs(y="Concordance (%)")+
coord_cartesian(ylim = c(50,100))
pl6<- pdj %>% filter(prog=="graphtyper_uniq") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())
pc3 <- ggdraw()+
draw_plot(pl5,0,0,1,1)+
draw_plot(pl6,0.6,0.3,0.3,0.4)
pc3
pg <- plot_grid(pc1,pc3,pc2,ncol = 3,align="h")
pg
### with BEAGLE and filter-imputed
head(pdall)
unique(pdall$prog)
## prog gatk
pl1 <- pdj %>% filter(prog=="gatk4_beagle") %>%
ggplot() +
geom_point(aes(x=mc,y=mp,col=contipe))+
facet_wrap(~prog)+
theme_bw()+
scale_color_brewer(palette = "Set1",labels=c("Heterozygous","Homozygous"))+
theme(axis.text = element_text(size=16),
axis.title.y = element_text(size=16,face="bold"),
axis.title.x=element_blank(),
legend.position = "none")+
labs(y="Concordance (%)")+
coord_cartesian(ylim = c(50,100))
pl2 <- pdj %>% filter(prog=="gatk4_beagle") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())
pl2
pc1 <- ggdraw()+
draw_plot(pl1,0,0,1,1)+
draw_plot(pl2,0.6,0.3,0.3,0.4)
pc1
pl3 <- pdj %>% filter(prog=="samtools_beagle") %>%
ggplot() +
geom_point(aes(x=mc,y=mp,col=contipe))+
facet_wrap(~prog)+
theme_bw()+
scale_color_brewer(palette = "Set1",labels=c("Heterozygous","Homozygous"))+
theme(axis.text = element_text(size=16),
axis.title = element_text(size=16,face="bold"),
legend.position = c(0.81,0.1),
legend.title = element_blank(),
legend.background = element_rect(colour = "black"),
legend.text = element_text(size=16))+
labs(x=NULL,y=NULL)+
coord_cartesian(ylim = c(50,100))
pl4<- pdj %>% filter(prog=="samtools_beagle") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())
pc2 <- ggdraw()+
draw_plot(pl3,0,0,1,1)+
draw_plot(pl4,0.6,0.3,0.3,0.4)
pc2
### graph
pl5 <- pdj %>% filter(prog=="graph_nofil_beagle") %>%
ggplot() +
geom_point(aes(x=mc,y=mp,col=contipe))+
facet_wrap(~prog)+
theme_bw()+
scale_color_brewer(palette = "Set1",labels=c("Heterozygous","Homozygous"))+
theme(axis.text = element_text(size=16),
axis.title = element_blank(),
legend.position = "none")+
labs(y="Concordance (%)")+
coord_cartesian(ylim = c(50,100))
pl6<- pdj %>% filter(prog=="graph_nofil_beagle") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())
pc3 <- ggdraw()+
draw_plot(pl5,0,0,1,1)+
draw_plot(pl6,0.6,0.3,0.3,0.4)
pc3
pg2 <- plot_grid(pc1,pc3,pc2,ncol = 3,align="h")
pg2
ggsave("pg_wb.svg")
ggsave("pg.svg")
getwd()
ggsave("pg_or.svg")
ggsave(pg,"pg_or.svg")
pg
ggsave("pg_oj.svg")
pl6<- pdj %>% filter(prog=="graphtyper_uniq") %>%
ggplot(aes(x=contipe,y=mp,col=contipe))+
geom_boxplot(show.legend = FALSE,outlier.shape = NA)+
geom_jitter(width=0.1,show.legend = FALSE,alpha=0.5,size=0.75)+
theme_bw()+
scale_color_brewer(palette = "Set1")+
theme(axis.title = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank())+
coord_cartesian(ylim = c(90,100))
